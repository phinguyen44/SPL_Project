age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   group.percentage(ifelse(IDX_m_l, df.out$age50_54, 0)))
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   group.percentage(ifelse(IDX_m_l, df.out$age50_54, 0)),
age55_59_ml_p=   group.percentage(ifelse(IDX_m_l, df.out$age55_59, 0)),
age60_64_ml_p=   group.percentage(ifelse(IDX_m_l, df.out$age60_64, 0)))
group.percentage(ifelse(IDX_m_l, df.out$age50_54, 0))
ifelse(IDX_m_l, df.out$age50_54, 0)
sum(ifelse(IDX_m_l, df.out$age50_54, 0))
labor.part.percentage = function(x, y){tapply(X = x[y], INDEX = df.out$country,
FUN = function(x[y]){
val = sum(x[y])/length(x[y])
return(val)
})}
labor.part.percentage = function(x, i){tapply(X = x[i], INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_w_l))
labor.part.percentage(df.out$age50_54, IDX_w_l)
lenght(df.out$age50_54)
length(df.out$age50_54)
length(IDX_m_l)
labor.part.percentage(df.out$age50_54, IDX_w_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_w_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x)
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_w_l)
length(df.out$age50_54)
sum(df.out$labor_ft) + sum(df.out$labor_pt)
6813/12784
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l))
IDX_m_l = ifelse(df.out$gender=="MALE"   & {df.out$labor_ft}, TRUE, FALSE)
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l))
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l))
View(sum.stats)
IDX_m_l = ifelse({df.out$gender=="MALE"}   & {df.out$labor_ft}, TRUE, FALSE)
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l))
IDX_m_l = ifelse({df.out$gender=="MALE"}   & {df.out$labor_ft | df.out$labor_pt}, TRUE, FALSE)
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l))
IDX_m_l = ifelse({df.out$gender=="MALE"}   & { df.out$labor_pt}, TRUE, FALSE)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_w_l)
length(df.out$age50_54)
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l))
sum(IDX_m_l)
IDX_m_l = ifelse({df.out$gender=="MALE"}   & {df.out$labor_ft | df.out$labor_pt}, TRUE, FALSE)
sum(IDX_m_l)
labor.part.percentage(df.out$age50_54, IDX_m_l)
x=df.out$age50_54
i=IDX_m_l
val = sum(x[i])/length(x[i])
sum(x)
x[i]
sum(x[i])
x
sum(x[i])
sum(x)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l))
sum(i)
sum(i)/length(i)
sum(df.out$labor_ft)
sum(df.out$labor_pt)
5012 + 1801
6813/12784
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l),
age55_59_ml_p=   labor.part.percentage(df.out$age55_59, IDX_m_l),
age60_64_ml_p=   labor.part.percentage(df.out$age60_64, IDX_m_l))
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l),
age55_59_ml_p=   labor.part.percentage(df.out$age55_59, IDX_m_l),
age60_64_ml_p=   labor.part.percentage(df.out$age60_64, IDX_m_l),
age50_54_wl_p=   labor.part.percentage(df.out$age50_54, IDX_w_l),
age55_59_wl_p=   labor.part.percentage(df.out$age55_59, IDX_w_l),
age60_64_wl_p=   labor.part.percentage(df.out$age60_64, IDX_w_l))
labor.part.percentage(df.out$age60_64, IDX_w_l)
IDX_w_l = ifelse({df.out$gender=="FEMALE"} & {df.out$labor_ft | df.out$labor_pt}, TRUE, FALSE)
IDX_m_l = ifelse({df.out$gender=="MALE"}   & {df.out$labor_ft | df.out$labor_pt}, TRUE, FALSE)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l),
age55_59_ml_p=   labor.part.percentage(df.out$age55_59, IDX_m_l),
age60_64_ml_p=   labor.part.percentage(df.out$age60_64, IDX_m_l),
age50_54_wl_p=   labor.part.percentage(df.out$age50_54, IDX_w_l),
age55_59_wl_p=   labor.part.percentage(df.out$age55_59, IDX_w_l),
age60_64_wl_p=   labor.part.percentage(df.out$age60_64, IDX_w_l))
rownames(sum.stats) = levels(df.out$country)
sum(IDX_w_l)
sum(IDX_m_l)
age60_64_wl_p=   labor.part.percentage(df.out$age60_64, IDX_w_l)
labor.part.percentage(df.out$age60_64, IDX_w_l)
labor.part.percentage(df.out$age60_64, IDX_m_l)
labor.part.percentage = function(x, i){apply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){sapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x[i])
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
sum(df.out$age50_54[IDX_m_l])/sum(df.out$age50_54)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x)
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x){
val = sum(x[i])/length(x)
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x)
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
sum(df.out$age50_54[IDX_m_l])/sum(df.out$age50_54)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x[i])/length(x)
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
val = sum(x)/length(x)
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(y, i){
val = sum(y[i])/length(y)
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){working = sum(x[i])
all     = length(x)
tapply(X = x, INDEX = df.out$country,
FUN = function(working, all){
val = working/all
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){working = sum(x[i])
all     = length(x)
tapply(X = x, INDEX = df.out$country,
FUN = function(working, all){
val = working/all
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(working, all){
working = sum(x[i])
all     = length(x)
val = working/all
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(working, all, i){
working = sum(x[i])
all     = length(x)
val = working/all
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
working = sum(x[i])
all     = length(x)
val = working/all
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
working = sum(x[i])
all     = length(x)
val = working/all
return(val)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
working = sum(x[i])
all     = length(x)
val = working/all
})}
labor.part.percentage(df.out$age50_54, IDX_m_l)
labor.part.percentage(df.out$age50_54, IDX_w_l)
IDX_w_l = ifelse({df.out$gender=="FEMALE"} & {df.out$labor_ft | df.out$labor_pt}, TRUE, FALSE)
labor.part.percentage(df.out$age50_54, IDX_w_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
working = ifelse(i, 1, 0)
all     = length(x)
val = working/all
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_w_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
working = sum(ifelse(i, 1, 0))
all     = length(x)
val = working/all
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_w_l)
labor.part.percentage = function(x, i){tapply(X = x, INDEX = df.out$country,
FUN = function(x, i){
i = i
working = sum(ifelse(i, 1, 0))
all     = length(x)
val = working/all
return(val)
})}
labor.part.percentage(df.out$age50_54, IDX_w_l)
z = function(z, i){aggregate(x = z,
by = i,
FUN = function(y){mean(y)
return(y)})}
z(df.out$age50_54, IDX_w_l)
k = list(IDX_m_l, IDX_w_l)
z(df.out$age50_54, k)
aggregate(df.out$labor_ft, by = k)
aggregate(df.out$labor_ft, by = k, FUN = n())
aggregate(df.out$labor_ft, by = k, FUN = sum()
labor.part.percentage(df.out$age50_54, IDX_w_l)
# there is an error in the function: not returning labor rate but age percentage
# Creating summary statistics dataframe with percentage entries/mean
sum.stats =
data.frame(matrix(nrow = 11, ncol = 0)) %>%
mutate(observation  = summary(df.out$country),
age50_54_p   =   group.percentage(df.out$age50_54),
age55_59_p   =   group.percentage(df.out$age55_59),
age60_64_p   =   group.percentage(df.out$age60_64),
age50_54_n   =   age50_54_p * observation,
age55_59_n   =   age55_59_p * observation,
age60_64_n   =   age60_64_p * observation,
h_chronic_p  =   group.percentage(df.out$h_chronic),
h_maxgrip_p  =   group.percentage(df.out$h_maxgrip),
h_adla_p     =   group.percentage(df.out$h_adla),
h_overweigh_p=   group.percentage(df.out$h_overweight),
h_obese_p    =   group.percentage(df.out$h_obese),
h_badment_p  =   group.percentage(df.out$h_badmental),
h_goodsp_p   =   group.percentage(df.out$h_goodsp),
age50_54_ml_p=   labor.part.percentage(df.out$age50_54, IDX_m_l),
age55_59_ml_p=   labor.part.percentage(df.out$age55_59, IDX_m_l),
age60_64_ml_p=   labor.part.percentage(df.out$age60_64, IDX_m_l),
age50_54_wl_p=   labor.part.percentage(df.out$age50_54, IDX_w_l),
age55_59_wl_p=   labor.part.percentage(df.out$age55_59, IDX_w_l),
age60_64_wl_p=   labor.part.percentage(df.out$age60_64, IDX_w_l))
rownames(sum.stats) = levels(df.out$country)
# Comment: Can we improve creating summary statistics by looping over certain variables?
# Comment: Adla percentages are way too low compared to article!!!
# Comment: labour participation rates are way to low!!! I think this has to do with the
# assumption that 0 hours are interpreted as not working
################################################################################
# VISUALIZE SUMMARY STATISTICS IN TABLES
# TODO: create function for table output
k = function(y){formattable(x = y)}
k(sum.stats[,1:4])
aggregate(df.out$labor_ft, by = k, FUN = sum())
aggregate(df.out$labor_ft, by = k, FUN = sum)
k = list(IDX_m_l, IDX_w_l)
k = list(IDX_m_l, IDX_w_l)
aggregate(df.out$labor_ft, by = k, FUN = sum)
aggregate(df.out$labor_ft, by = df.out$country, FUN = sum)
k = list(IDX_m_l, IDX_w_l, df.out$country)
k = list(df.out$country)
z(df.out$age50_54, k)
k = list(levels(df.out$country))
z(df.out$age50_54, k)
z(df.out$age50_54, k)
